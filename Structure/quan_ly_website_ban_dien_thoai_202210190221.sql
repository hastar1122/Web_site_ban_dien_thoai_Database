--
-- Script was generated by Devart dbForge Studio 2020 for MySQL, Version 9.0.338.0
-- Product home page: http://www.devart.com/dbforge/mysql/studio
-- Script date 10/24/2022 8:22:45 AM
-- Server version: 8.0.30
-- Client version: 4.1
--

-- 
-- Disable foreign keys
-- 
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;

-- 
-- Set SQL mode
-- 
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;

-- 
-- Set character set the client will use to send SQL statements to the server
--
SET NAMES 'utf8';

--
-- Set default database
--
USE quan_ly_website_ban_dien_thoai;

--
-- Drop table `promotioncategory`
--
DROP TABLE IF EXISTS promotioncategory;

--
-- Drop table `promotion`
--
DROP TABLE IF EXISTS promotion;

--
-- Drop table `productitem`
--
DROP TABLE IF EXISTS productitem;

--
-- Drop table `orderdetail`
--
DROP TABLE IF EXISTS orderdetail;

--
-- Drop table `productconfiguration`
--
DROP TABLE IF EXISTS productconfiguration;

--
-- Drop table `product`
--
DROP TABLE IF EXISTS product;

--
-- Drop table `categoryvariation`
--
DROP TABLE IF EXISTS categoryvariation;

--
-- Drop table `variationoption`
--
DROP TABLE IF EXISTS variationoption;

--
-- Drop table `variation`
--
DROP TABLE IF EXISTS variation;

--
-- Drop table `category`
--
DROP TABLE IF EXISTS category;

--
-- Drop table `order`
--
DROP TABLE IF EXISTS `order`;

--
-- Drop table `orderstatus`
--
DROP TABLE IF EXISTS orderstatus;

--
-- Drop table `brand`
--
DROP TABLE IF EXISTS brand;

--
-- Drop table `user`
--
DROP TABLE IF EXISTS user;

--
-- Drop table `role`
--
DROP TABLE IF EXISTS role;

--
-- Set default database
--
USE quan_ly_website_ban_dien_thoai;

--
-- Create table `role`
--
CREATE TABLE role (
  RoleID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  RoleName varchar(255) DEFAULT NULL COMMENT 'Tên vai trò',
  PRIMARY KEY (RoleID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng vai trò người dùng';

--
-- Create table `user`
--
CREATE TABLE user (
  UserID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  UserAccount varchar(255) DEFAULT NULL COMMENT 'Tài khoản người dùng',
  Password varchar(255) DEFAULT NULL COMMENT 'Mật khẩu',
  UserName varchar(255) DEFAULT NULL COMMENT 'Tên người dùng',
  Address varchar(255) DEFAULT NULL COMMENT 'Địa chỉ',
  Email varchar(255) DEFAULT NULL COMMENT 'Email',
  PhoneNumber varchar(20) DEFAULT NULL COMMENT 'Số điện thoại',
  Image text DEFAULT NULL COMMENT 'Hình ảnh avatar',
  RoleID int DEFAULT NULL COMMENT 'Vai trò người dùng (Khóa ngoại)',
  PRIMARY KEY (UserID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng người dùng';

--
-- Create foreign key
--
ALTER TABLE user
ADD CONSTRAINT FK_user_role_RoleID FOREIGN KEY (RoleID)
REFERENCES role (RoleID);

--
-- Create table `brand`
--
CREATE TABLE brand (
  BrandID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  SubBrandID int DEFAULT NULL COMMENT 'Thương hiệu con (Khóa ngoại)',
  BrandName varchar(255) DEFAULT NULL COMMENT 'Tên thương hiệu',
  PRIMARY KEY (BrandID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng thương hiệu';

--
-- Create foreign key
--
ALTER TABLE brand
ADD CONSTRAINT FK_brand_brand_BrandID FOREIGN KEY (SubBrandID)
REFERENCES brand (BrandID);

--
-- Create table `orderstatus`
--
CREATE TABLE orderstatus (
  OrderStatusID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  OrderStatus varchar(255) DEFAULT NULL COMMENT 'Trạng thái đơn đặt',
  PRIMARY KEY (OrderStatusID)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng trạng thái đơn đặt';

--
-- Create table `order`
--
CREATE TABLE `order` (
  OrderID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  UserID int DEFAULT NULL COMMENT 'Người đặt (Khóa ngoại)',
  OrderDate datetime DEFAULT NULL COMMENT 'Thời gian đặt',
  TotalAmount float DEFAULT NULL COMMENT 'Tổng tiền',
  OrderStatusID int DEFAULT NULL COMMENT 'Trạng thái (Khóa ngoại)',
  PRIMARY KEY (OrderID)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng đơn đặt hàng';

--
-- Create foreign key
--
ALTER TABLE `order`
ADD CONSTRAINT FK_order_orderstatus_OrderStatusID FOREIGN KEY (OrderStatusID)
REFERENCES orderstatus (OrderStatusID);

--
-- Create foreign key
--
ALTER TABLE `order`
ADD CONSTRAINT FK_order_user_UserID FOREIGN KEY (UserID)
REFERENCES user (UserID);

--
-- Create table `category`
--
CREATE TABLE category (
  CategoryID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  ProductCategoryName varchar(255) DEFAULT NULL COMMENT 'Tên loại sản phẩm',
  CategoryParentID int DEFAULT NULL COMMENT 'Loại sản phẩm cha (Khóa ngoại)',
  PRIMARY KEY (CategoryID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 3,
AVG_ROW_LENGTH = 16384,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng loại sản phẩm';

--
-- Create foreign key
--
ALTER TABLE category
ADD CONSTRAINT FK_category_category_CategoryID FOREIGN KEY (CategoryParentID)
REFERENCES category (CategoryID);

--
-- Create table `variation`
--
CREATE TABLE variation (
  VariationID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  ProductCategoryID int DEFAULT NULL COMMENT 'Loại sản phẩm (Khóa ngoại)',
  VariationName varchar(255) DEFAULT NULL COMMENT 'Tên loại đặc trưng',
  PRIMARY KEY (VariationID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 4,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng loại đặc trưng';

--
-- Create foreign key
--
ALTER TABLE variation
ADD CONSTRAINT FK_variation_productcategory_ProductCategoryID FOREIGN KEY (ProductCategoryID)
REFERENCES category (CategoryID);

--
-- Create table `variationoption`
--
CREATE TABLE variationoption (
  VariationOptionID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  VariationID int DEFAULT NULL COMMENT 'Loại đặc trưng (Khóa ngoại)',
  Value varchar(255) DEFAULT NULL COMMENT 'Giá trị',
  PRIMARY KEY (VariationOptionID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 10,
AVG_ROW_LENGTH = 2048,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng đặc trưng';

--
-- Create foreign key
--
ALTER TABLE variationoption
ADD CONSTRAINT FK_variationoption_variation_VariationID FOREIGN KEY (VariationID)
REFERENCES variation (VariationID);

--
-- Create table `categoryvariation`
--
CREATE TABLE categoryvariation (
  CategoryVariationID int NOT NULL AUTO_INCREMENT,
  CategoryID int DEFAULT NULL,
  VariationID int DEFAULT NULL,
  PRIMARY KEY (CategoryVariationID)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng trung gian giữa bảng loại sản phẩm và loại đặc trưng';

--
-- Create foreign key
--
ALTER TABLE categoryvariation
ADD CONSTRAINT FK_categoryvariation_category_CategoryID FOREIGN KEY (CategoryID)
REFERENCES category (CategoryID);

--
-- Create foreign key
--
ALTER TABLE categoryvariation
ADD CONSTRAINT FK_categoryvariation_variation_VariationID FOREIGN KEY (VariationID)
REFERENCES variation (VariationID);

--
-- Create table `product`
--
CREATE TABLE product (
  ProductID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  ProductParentID int DEFAULT NULL COMMENT 'Sản phẩm cha (Khóa ngoại)',
  ProductCode varchar(255) DEFAULT NULL COMMENT 'Mã sản phẩm',
  ProductName varchar(255) DEFAULT NULL COMMENT 'Tên sản phẩm',
  CategoryID int DEFAULT NULL COMMENT 'Loại sản phẩm (Khóa ngoại)',
  BrandID int DEFAULT NULL COMMENT 'Thương hiệu (Khóa ngoại)',
  Price float DEFAULT NULL COMMENT 'Giá bán',
  ProductDescription text DEFAULT NULL COMMENT 'Mô tả',
  Amount int DEFAULT NULL COMMENT 'Số lượng',
  Image varchar(255) DEFAULT NULL COMMENT 'Hình ảnh',
  PRIMARY KEY (ProductID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 4,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng sản phẩm';

--
-- Create foreign key
--
ALTER TABLE product
ADD CONSTRAINT FK_product_brand_BrandID FOREIGN KEY (BrandID)
REFERENCES brand (BrandID);

--
-- Create foreign key
--
ALTER TABLE product
ADD CONSTRAINT FK_product_product_ProductID FOREIGN KEY (ProductParentID)
REFERENCES product (ProductID);

--
-- Create foreign key
--
ALTER TABLE product
ADD CONSTRAINT FK_product_productcategory_ProductCategoryID FOREIGN KEY (CategoryID)
REFERENCES category (CategoryID);

--
-- Create table `productconfiguration`
--
CREATE TABLE productconfiguration (
  ProductConfigurationID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  ProductID int NOT NULL COMMENT 'Sản phẩm (Khóa ngoại)',
  VariationOptionID int NOT NULL COMMENT 'Giá trị đặc trưng (Khóa ngoại)',
  PRIMARY KEY (ProductConfigurationID)
)
ENGINE = INNODB,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng trung gian giữa chi tiết sản phẩm và các đặc trưng sản phẩm';

--
-- Create foreign key
--
ALTER TABLE productconfiguration
ADD CONSTRAINT FK_productconfiguration_product_ProductID FOREIGN KEY (ProductID)
REFERENCES product (ProductID);

--
-- Create foreign key
--
ALTER TABLE productconfiguration
ADD CONSTRAINT FK_productconfiguration_variationoption_VariationOptionID FOREIGN KEY (VariationOptionID)
REFERENCES variationoption (VariationOptionID);

--
-- Create table `orderdetail`
--
CREATE TABLE orderdetail (
  OrderDetailID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  OrderID int DEFAULT NULL COMMENT 'Đơn đặt hàng (Khóa ngoại)',
  ProductID int DEFAULT NULL COMMENT 'Sản phẩm (Khóa ngoại)',
  Amount int DEFAULT NULL COMMENT 'Số lượng',
  Price float DEFAULT NULL COMMENT 'Thành tiền',
  PRIMARY KEY (OrderDetailID)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng chi tiết đơn đặt';

--
-- Create index `FK_orderdetail_productitem_ProductItemID` on table `orderdetail`
--
ALTER TABLE orderdetail
ADD INDEX FK_orderdetail_productitem_ProductItemID (ProductID);

--
-- Create foreign key
--
ALTER TABLE orderdetail
ADD CONSTRAINT FK_orderdetail_order_OrderID FOREIGN KEY (OrderID)
REFERENCES `order` (OrderID);

--
-- Create foreign key
--
ALTER TABLE orderdetail
ADD CONSTRAINT FK_orderdetail_product_ProductID FOREIGN KEY (ProductID)
REFERENCES product (ProductID);

--
-- Create table `productitem`
--
CREATE TABLE productitem (
  ProductItemID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa ngoại thông tin chi tiết sản phâm',
  ProductID int NOT NULL COMMENT 'Sản phẩm (Khóa ngoại)',
  OrderDetailID int DEFAULT NULL,
  SKU varchar(255) DEFAULT NULL COMMENT 'Số định danh xác định cho từng sản phẩm (VD: IMEI)',
  Status bit(1) DEFAULT NULL COMMENT 'Trạng thái (0: Chưa bán, 1: Đã bán)',
  PRIMARY KEY (ProductItemID)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng chi tiết từng sản phẩm';

--
-- Create foreign key
--
ALTER TABLE productitem
ADD CONSTRAINT FK_productitem_orderdetail_OrderDetailID FOREIGN KEY (OrderDetailID)
REFERENCES orderdetail (OrderDetailID);

--
-- Create foreign key
--
ALTER TABLE productitem
ADD CONSTRAINT FK_productitem_product_ProductID FOREIGN KEY (ProductID)
REFERENCES product (ProductID);

--
-- Create table `promotion`
--
CREATE TABLE promotion (
  PromotionID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  PromotionName varchar(255) DEFAULT NULL COMMENT 'Tên khuyến mại',
  Description varchar(255) DEFAULT NULL COMMENT 'Mô tả',
  DiscountRate float DEFAULT NULL COMMENT 'Phần trăm giảm giá',
  StartDate datetime DEFAULT NULL COMMENT 'Thời gian bắt đầu',
  EndDate datetime DEFAULT NULL COMMENT 'Thời gian kết thúc',
  PRIMARY KEY (PromotionID)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng khuyến mại';

--
-- Create table `promotioncategory`
--
CREATE TABLE promotioncategory (
  PromotionCategoryID int NOT NULL AUTO_INCREMENT COMMENT 'Khóa chính',
  PromotionID int DEFAULT NULL,
  CategoryID int DEFAULT NULL,
  PRIMARY KEY (PromotionCategoryID)
)
ENGINE = INNODB,
CHARACTER SET utf8mb4,
COLLATE utf8mb4_0900_ai_ci,
COMMENT = 'Bảng trung gian giữa bảng khuyến mại và loại sản phẩm';

--
-- Create foreign key
--
ALTER TABLE promotioncategory
ADD CONSTRAINT FK_promotioncategory_productcategory_ProductCategoryID FOREIGN KEY (CategoryID)
REFERENCES category (CategoryID);

--
-- Create foreign key
--
ALTER TABLE promotioncategory
ADD CONSTRAINT FK_promotioncategory_promotion_PromotionID FOREIGN KEY (PromotionID)
REFERENCES promotion (PromotionID);

-- 
-- Dumping data for table role
--
INSERT INTO role VALUES
(1, 'employee'),
(2, 'admin');

-- 
-- Dumping data for table brand
--
INSERT INTO brand VALUES
(2, NULL, 'Apple');

-- 
-- Dumping data for table user
--
INSERT INTO user VALUES
(1, 'truonghieu', '123', 'Truong Minh Hieu', 'Thai Binh', 'truongminhhieu152@gmail.com', '0392417241', 'a.jpg', 1),
(2, 'admin', '12345', 'Minh Hiếu', 'Hà Nội', 'hieu110501@gmail.com', '099993213', 'x.jpg', 2);

-- 
-- Dumping data for table orderstatus
--
-- Table quan_ly_website_ban_dien_thoai.orderstatus does not contain any data (it is empty)

-- 
-- Dumping data for table category
--
INSERT INTO category VALUES
(1, 'Điện thoại', NULL);

-- 
-- Dumping data for table product
--
INSERT INTO product VALUES
(3, NULL, 'SP-01', 'Iphone 13', 1, 2, NULL, 'Xịn', NULL, '');

-- 
-- Dumping data for table `order`
--
-- Table quan_ly_website_ban_dien_thoai.`order` does not contain any data (it is empty)

-- 
-- Dumping data for table variation
--
INSERT INTO variation VALUES
(1, 1, 'Màu sắc'),
(2, 1, 'Ram'),
(3, 1, 'Rom');

-- 
-- Dumping data for table promotion
--
-- Table quan_ly_website_ban_dien_thoai.promotion does not contain any data (it is empty)

-- 
-- Dumping data for table orderdetail
--
-- Table quan_ly_website_ban_dien_thoai.orderdetail does not contain any data (it is empty)

-- 
-- Dumping data for table variationoption
--
INSERT INTO variationoption VALUES
(1, 1, 'Đỏ'),
(2, 1, 'Đen'),
(3, 1, 'Trắng'),
(4, 2, '8'),
(5, 2, '16'),
(6, 2, '32'),
(7, 3, '64'),
(8, 3, '128'),
(9, 3, '256');

-- 
-- Dumping data for table promotioncategory
--
-- Table quan_ly_website_ban_dien_thoai.promotioncategory does not contain any data (it is empty)

-- 
-- Dumping data for table productitem
--
-- Table quan_ly_website_ban_dien_thoai.productitem does not contain any data (it is empty)

-- 
-- Dumping data for table productconfiguration
--
-- Table quan_ly_website_ban_dien_thoai.productconfiguration does not contain any data (it is empty)

-- 
-- Dumping data for table categoryvariation
--
-- Table quan_ly_website_ban_dien_thoai.categoryvariation does not contain any data (it is empty)

-- 
-- Restore previous SQL mode
-- 
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;

-- 
-- Enable foreign keys
-- 
/*!40014 SET FOREIGN_KEY_CHECKS = @OLD_FOREIGN_KEY_CHECKS */;